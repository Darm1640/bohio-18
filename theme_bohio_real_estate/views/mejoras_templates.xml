<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- ======================================================================= -->
    <!-- ARCHIVO DE MEJORAS - TEMPLATES ADICIONALES -->
    <!-- ======================================================================= -->
    <!-- NOTA: Este archivo contiene templates de mejoras opcionales.
         Muchos templates fueron removidos el 2025-10-18 porque intentaban
         modificar elementos que fueron eliminados durante la simplificación
         de la página de propiedades.

         Templates removidos:
         - homepage_search_improved (heredaba de bohio_homepage_new)
         - project_card_improved (template sin uso activo)
         - shop_filters_improved (heredaba elementos eliminados)
         - shop_counter_improved (heredaba elementos eliminados)
    -->

    <!-- ======================================================================= -->
    <!-- SCRIPTS ADICIONALES PARA FILTROS -->
    <!-- ======================================================================= -->

    <template id="bohio_scripts_improved" name="BOHIO Scripts Improved" inherit_id="website.layout">
        <xpath expr="//head" position="inside">
            <script type="text/javascript">
                // Función para actualizar filtros dinámicamente
                function updateDynamicFilters() {
                    // Esta función se implementa en el archivo JS
                    if (window.loadDynamicFilters) {
                        window.loadDynamicFilters();
                    }
                }

                // Función para limpiar todos los filtros
                function clearAllFilters() {
                    window.location.href = '/properties';
                }

                // Mostrar/ocultar filtros activos
                function updateActiveFiltersDisplay() {
                    const params = new URLSearchParams(window.location.search);
                    const badgesContainer = document.getElementById('activeFiltersBadges');
                    const displayContainer = document.getElementById('activeFiltersDisplay');

                    if (!badgesContainer || !displayContainer) return;

                    badgesContainer.innerHTML = '';
                    let hasFilters = false;

                    // Mapear nombres de filtros a labels amigables
                    const filterLabels = {
                        'type_service': 'Servicio',
                        'property_type': 'Tipo',
                        'city_id': 'Ciudad',
                        'region_id': 'Barrio',
                        'bedrooms': 'Habitaciones',
                        'bathrooms': 'Baños',
                        'min_price': 'Precio mín',
                        'max_price': 'Precio máx'
                    };

                    params.forEach((value, key) => {
                        if (value &amp;&amp; filterLabels[key]) {
                            hasFilters = true;
                            const badge = document.createElement('span');
                            badge.className = 'badge bg-danger';
                            badge.innerHTML = `${filterLabels[key]}: ${value} <i class="bi bi-x ms-1" style="cursor: pointer;" onclick="removeFilter('${key}')"></i>`;
                            badgesContainer.appendChild(badge);
                        }
                    });

                    displayContainer.style.display = hasFilters ? 'block' : 'none';
                }

                // Remover un filtro específico
                function removeFilter(filterKey) {
                    const params = new URLSearchParams(window.location.search);
                    params.delete(filterKey);
                    window.location.search = params.toString();
                }

                // Ejecutar al cargar la página
                document.addEventListener('DOMContentLoaded', function() {
                    updateActiveFiltersDisplay();
                });
            </script>
        </xpath>
    </template>

</odoo>
