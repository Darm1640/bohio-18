<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">

<t t-name="theme_bohio_real_estate.PropertyCarousel" owl="1">
    <div class="bohio-property-carousel">
        <!-- Loading -->
        <t t-if="state.loading">
            <div class="text-center py-5">
                <div class="spinner-border text-danger" role="status">
                    <span class="visually-hidden">Cargando propiedades...</span>
                </div>
            </div>
        </t>

        <!-- Error -->
        <t t-elif="state.error">
            <div class="alert alert-warning" role="alert">
                <i class="fa fa-exclamation-triangle me-2"></i>
                <span t-esc="state.error"></span>
                <button class="btn btn-link ms-auto" t-on-click="loadProperties">
                    Reintentar
                </button>
            </div>
        </t>

        <!-- Empty -->
        <t t-elif="state.properties.length == 0">
            <div class="text-center py-5">
                <i class="fa fa-home fa-3x text-muted mb-3"></i>
                <p class="text-muted">No hay propiedades disponibles</p>
            </div>
        </t>

        <!-- Carousel -->
        <t t-else="">
            <div class="carousel slide" data-bs-ride="carousel">
                <div class="carousel-inner">
                    <t t-foreach="slides" t-as="slide" t-key="slide_index">
                        <div t-att-class="'carousel-item' + (slide_index == 0 ? ' active' : '')">
                            <div class="row g-4">
                                <t t-foreach="slide" t-as="prop" t-key="prop.id">
                                    <div class="col-12 col-md-6 col-lg-3">
                                        <div class="card h-100 shadow-sm border-0 position-relative">
                                            <!-- Proyecto Badge -->
                                            <t t-if="prop.project_id">
                                                <div class="position-absolute top-0 end-0 m-2">
                                                    <a t-attf-href="/proyecto/{{prop.project_id}}"
                                                       class="badge bg-danger text-white text-decoration-none">
                                                        <i class="fa fa-building me-1"></i>
                                                        <t t-esc="prop.project_name"></t>
                                                    </a>
                                                </div>
                                            </t>

                                            <!-- Imagen -->
                                            <img t-attf-src="{{prop.image_url or '/theme_bohio_real_estate/static/src/img/placeholder.jpg'}}"
                                                 t-att-alt="prop.name"
                                                 class="card-img-top"
                                                 style="height: 200px; object-fit: cover;"
                                                 loading="lazy"/>

                                            <!-- Body -->
                                            <div class="card-body d-flex flex-column">
                                                <h5 class="card-title text-truncate" t-att-title="prop.name">
                                                    <t t-esc="prop.name"></t>
                                                </h5>

                                                <p class="text-muted small mb-2">
                                                    <i class="fa fa-map-marker-alt me-1"></i>
                                                    <t t-esc="getLocation(prop)"></t>
                                                </p>

                                                <div class="d-flex justify-content-between mb-2 text-muted small">
                                                    <span t-if="prop.area > 0">
                                                        <i class="fa fa-ruler-combined me-1"></i>
                                                        <t t-esc="prop.area"></t> mÂ²
                                                    </span>
                                                    <span t-if="prop.bedrooms > 0">
                                                        <i class="fa fa-bed me-1"></i>
                                                        <t t-esc="prop.bedrooms"></t>
                                                    </span>
                                                    <span t-if="prop.bathrooms > 0">
                                                        <i class="fa fa-bath me-1"></i>
                                                        <t t-esc="prop.bathrooms"></t>
                                                    </span>
                                                </div>

                                                <div class="mb-2">
                                                    <small class="text-muted">
                                                        <t t-esc="priceLabel(prop)"></t>
                                                    </small>
                                                    <h4 class="text-danger mb-0">
                                                        <t t-esc="formatPrice(prop)"></t>
                                                    </h4>
                                                </div>

                                                <a t-attf-href="{{prop.url}}"
                                                   class="btn btn-outline-danger w-100 mt-auto">
                                                    <i class="fa fa-eye me-1"></i> Ver detalles
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </t>
                            </div>
                        </div>
                    </t>
                </div>

                <!-- Controles -->
                <t t-if="slides.length > 1">
                    <button class="carousel-control-prev" type="button" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Anterior</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Siguiente</span>
                    </button>
                </t>
            </div>
        </t>
    </div>
</t>

</templates>
